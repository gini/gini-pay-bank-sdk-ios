<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Integration  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="Integration  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
        <img class="logo-icon" src="img/logo.png"/>
    
        </a>
        
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/gini/gini-pay-bank-sdk-ios.git">
            <img class="header-icon" src="img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">GiniPayBank Reference</a>
      <img class="carat" src="img/carat.png" />
      Integration  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Documentation.html">Documentation</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="installation.html">Installation</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="integration.html">Integration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="migration.html">Migration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="license.html">License</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Guides.html">Other Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="customization-guide.html">Customization guide</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="error-logging-guide.html">Error logging guide</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="event-tracking-guide.html">Event tracking guide</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="import-pdfs-and-images-guide.html">Import PDFs and images guide</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="open-with-guide.html">Open with guide</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="qr-code-scanning-guide.html">QR Code scanning guide</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Classes.html">Other Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DigitalInvoiceViewController.html">DigitalInvoiceViewController</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DigitalInvoiceViewController/Section.html">– Section</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniPayBank.html">GiniPayBank</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniPayBankConfiguration.html">GiniPayBankConfiguration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniPayBankNetworkingScreenApiCoordinator.html">GiniPayBankNetworkingScreenApiCoordinator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ReturnAssistantConfiguration.html">ReturnAssistantConfiguration</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Global Variables.html">Other Global Variables</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Global%20Variables.html#/s:11GiniPayBank13versionStringSSvp">versionString</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Enumerations.html">Other Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/GiniPayBankError.html">GiniPayBankError</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Extensions.html">Other Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/DocumentServiceProtocol.html">DocumentServiceProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/LocalizableStringResource.html">LocalizableStringResource</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/ReturnReason.html">ReturnReason</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/String.html">String</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/URL.html">URL</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Functions.html">Other Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Functions.html#/s:11GiniPayBank23receivePaymentRequestId3url10completiony10Foundation3URLV_ys6ResultOySSAA0abC5ErrorOGctF">receivePaymentRequestId(url:completion:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Protocols.html">Other Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/DigitalInvoiceViewControllerDelegate.html">DigitalInvoiceViewControllerDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Protocols.html#/s:11GiniPayBank0abC16AnalysisDelegateP">GiniPayBankAnalysisDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Structures.html">Other Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DigitalInvoice.html">DigitalInvoice</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DigitalInvoice/DigitalInvoiceParsingException.html">– DigitalInvoiceParsingException</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DigitalInvoice.html#/s:11GiniPayBank14DigitalInvoiceV8LineItemV">– LineItem</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PaymentInfo.html">PaymentInfo</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            
            <h1 id='integration' class='heading'>Integration</h1>

<p>Gini Pay provides an information extraction system for analyzing business invoices and transfers them to the iOS banking app, where the payment process will be completed.</p>

<p>The Gini Pay Bank SDK for iOS provides functionality to upload the multipage documents with mobile phones, accurate line item extraction enables the user to to pay the invoice with prefferable payment provider. </p>
<h1 id='payment-functionality' class='heading'>Payment functionality</h1>

<p><strong>Note</strong> For supporting your banking app as a payment provider you need to register Gini Pay URL scheme in you  in your <code>Info.plist</code> file. Gini Pay URL schemes for specification will be provided by Gini.</p>

<p><br>
<center><img src="img/definingCustomUrl.png" height="200"/></center>
</br></p>
<h4 id='giniapilib-initialization' class='heading'>GiniApiLib initialization</h4>

<p>If you want to use a transparent proxy with your own authentication you can specify your own domain and add <code>AlternativeTokenSource</code> protocol implementation:</p>
<pre class="highlight swift"><code> <span class="k">let</span> <span class="nv">apiLib</span> <span class="o">=</span>  <span class="kt">GiniApiLib</span><span class="o">.</span><span class="kt">Builder</span><span class="p">(</span><span class="nv">customApiDomain</span><span class="p">:</span> <span class="s">"api.custom.net"</span><span class="p">,</span>
                                 <span class="nv">alternativeTokenSource</span><span class="p">:</span> <span class="kt">MyAlternativeTokenSource</span><span class="p">)</span>
                                 <span class="o">.</span><span class="nf">build</span><span class="p">()</span>
</code></pre>

<p>The token your provide will be added as a bearer token to all api.custom.net requests.</p>

<p>Optionally if you want to use <em>Certificate pinning</em>, provide metadata for the upload process, you can pass both your public key pinning configuration (see <a href="https://github.com/datatheorem/TrustKit">TrustKit repo</a> for more information)</p>
<pre class="highlight swift"><code>    <span class="k">let</span> <span class="nv">giniApiLib</span> <span class="o">=</span> <span class="kt">GiniApiLib</span>
        <span class="o">.</span><span class="kt">Builder</span><span class="p">(</span><span class="nv">client</span><span class="p">:</span> <span class="kt">Client</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"your-id"</span><span class="p">,</span>
                                <span class="nv">secret</span><span class="p">:</span> <span class="s">"your-secret"</span><span class="p">,</span>
                                <span class="nv">domain</span><span class="p">:</span> <span class="s">"your-domain"</span><span class="p">),</span>
                 <span class="nv">api</span><span class="p">:</span> <span class="o">.</span><span class="k">default</span><span class="p">,</span>
                 <span class="nv">pinningConfig</span><span class="p">:</span> <span class="n">yourPublicPinningConfig</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">build</span><span class="p">()</span>
</code></pre>

<blockquote>
<p>⚠️  <strong>Important</strong></p>

<ul>
<li>The document metadata for the upload process is intended to be used for reporting.</li>
</ul>
</blockquote>
<h2 id='ginipaybank-initialization' class='heading'>GiniPayBank initialization</h2>

<p>Now that the <code>GiniApiLib</code> has been initialized, you can initialize <code><a href="Classes/GiniPayBank.html">GiniPayBank</a></code></p>
<pre class="highlight swift"><code> <span class="k">let</span> <span class="nv">bankSDK</span> <span class="o">=</span> <span class="kt">GiniPayBank</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">giniApiLib</span><span class="p">)</span>
</code></pre>

<p>and receive the payment requestID in <code>AppDelegate</code>. For handling incoming URL, please use the code snippet below.</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="n">_</span> <span class="nv">app</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span>
                     <span class="kd">open</span> <span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span><span class="p">,</span>
                     <span class="nv">options</span><span class="p">:</span> <span class="p">[</span><span class="kt">UIApplication</span><span class="o">.</span><span class="kt">OpenURLOptionsKey</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">[:])</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
        <span class="nf">receivePaymentRequestId</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
            <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
            <span class="k">case</span> <span class="kd">let</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="n">requestId</span><span class="p">):</span>
                <span class="k">self</span><span class="o">.</span><span class="n">paymentRequestId</span> <span class="o">=</span> <span class="n">requestId</span>
            <span class="k">case</span> <span class="o">.</span><span class="nv">failure</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">true</span>
    <span class="p">}</span>
</code></pre>
<h2 id='fetching-payment-information' class='heading'>Fetching payment information</h2>

<p>After receiving the payment request id you can get fetch the payment information:</p>
<pre class="highlight swift"><code>
<span class="n">bankSDK</span><span class="o">.</span><span class="nf">receivePaymentRequest</span><span class="p">(</span><span class="nv">paymentRequestId</span><span class="p">:</span> <span class="n">appDelegate</span><span class="o">.</span><span class="n">paymentRequestId</span><span class="p">)</span>

</code></pre>

<p>The method above returns the completion block with the struct <code>PaymentRequest</code>, which includes recipient, iban, amount and purpose fields.</p>
<h2 id='resolving-payment-request' class='heading'>Resolving payment request</h2>
<pre class="highlight swift"><code>
<span class="n">bankSDK</span><span class="o">.</span><span class="nf">resolvePaymentRequest</span><span class="p">(</span><span class="nv">paymentRequesId</span><span class="p">:</span> <span class="n">appDelegate</span><span class="o">.</span><span class="n">paymentRequestId</span><span class="p">,</span>
                                 <span class="nv">paymentInfo</span><span class="p">:</span> <span class="n">paymentInfo</span><span class="p">)</span>

</code></pre>

<p>The method above returns the completion block with the struct <code>ResolvedPaymentRequest</code>, which includes <code>requesterUri</code> for redirecting back to the payment requester&rsquo;s app.</p>
<h2 id='redirecting-back-to-the-payment-requester-app' class='heading'>Redirecting back to the payment requester app</h2>

<p>If the payment request was successfully resolved you can allow the user redirect back to the payment requester app:</p>
<pre class="highlight swift"><code><span class="n">bankSDK</span><span class="o">.</span><span class="nf">returnBackToBusinessAppHandler</span><span class="p">(</span><span class="nv">resolvedPaymentRequest</span><span class="p">:</span> <span class="n">resolvedPayment</span><span class="p">)</span>
</code></pre>
<h2 id='gini-pay-scheme-for-your-app' class='heading'>Gini Pay Scheme For Your App</h2>

<p>In order for your banking app to be available as a payment provider and support the Gini Pay Connect functionality, you need to register a URL scheme for your app known by the Gini Pay API.</p>

<p>You should already have a scheme and host from us. Please contact us in case you don&rsquo;t have them.</p>

<p>The following is an example for the scheme ginipay-bank://
<br>
<center><img src="img/Integration guide/BankSchemeExample.png" height="200"/></center>
</br></p>
<h2 id='testing' class='heading'>Testing</h2>

<p>An example business app is available in the <a href="https://github.com/gini/gini-pay-business-sdk-ios">Gini Pay Business SDK&rsquo;s</a> repository.</p>

<p>In order to test using our example business app, you need to use development client credentials. This will make sure that the Gini Pay Business SDK uses a payment provider which will open your development banking app.</p>

<p>To inject your Gini Pay API credentials into the business example app you need to fill in your credentials in <code>Example/Example Swift/Credentials.plist</code>.</p>

<p>You also need to replace the <code>ginipay-bank</code> URL scheme in the example business app&rsquo;s <code>LSApplicationQueriesSchemes</code> in the <code>Info.plist</code> with the Gini Pay URL scheme we provided for your banking app.</p>
<h4 id='end-to-end-testing' class='heading'>End to end testing</h4>

<p>After you&rsquo;ve set the client credentials in the example business app and installed it on your device you can start the payment flow with a document import or by taking a photo.</p>

<p>After following the integration steps above your banking app will be launched and you&rsquo;ll be able to fetch the payment request, show the payment information and resolve the payment after the transaction has been confirmed. At this point, you may redirect back to the business app.</p>

<p>With these steps completed you have verified that your app, the Gini Pay API, the Gini Pay Business SDK and the Gini Pay
Bank SDK work together correctly.</p>
<h4 id='testing-in-production' class='heading'>Testing in production</h4>

<p>The steps are the same but instead of the development client credentials, you will need to use production client credentials. This will make sure the Gini Pay Business SDK receives real payment providers including the one which opens your production banking app.</p>

<p>For testing the flow using the example business app you will need to add your banking app&rsquo;s production Gini Pay URL scheme to <code>LSApplicationQueriesSchemes</code> in the example business app&rsquo;s <code>Info.plist</code>. Also please make sure that production client credentials are used before installing it.</p>

<p>You can also test with a real business app. Please contact us in case you don&rsquo;t know which business app(s) to install for starting the payment flow.</p>
<h1 id='photo-payment-functionality' class='heading'>Photo payment functionality</h1>

<p>The Gini Pay Bank SDK provides two integration options. A <a href="#screen-api">Screen API</a> that is easy to implement and a more complex, but also more flexible <a href="#component-api">Component API</a>. Both APIs can access the complete functionality of the SDK.</p>

<p><strong>Note</strong>: Irrespective of the option you choose if you want to support <strong>iOS 10</strong> you need to specify the <code>NSCameraUsageDescription</code> key in your <code>Info.plist</code> file. This key is mandatory for all apps since iOS 10 when using the <code>Camera</code> framework.
Also if you&rsquo;re using the <a href="https://github.com/gini/gini-pay-api-lib-ios">Gini Pay Api Library</a> you need to add support for &ldquo;Keychain Sharing&rdquo; in your entitlements by adding a <code>keychain-access-groups</code> value to your entitlements file. For more information see the <a href="https://developer.gini.net/gini-pay-api-lib-ios/docs/getting-started.html">Integration Guide</a> of the Gini Pay Api Library.</p>
<h2 id='screen-api' class='heading'>Screen API</h2>

<p>The Screen API provides a custom <code>UIViewController</code> object, which can be presented modally. It handles the complete process from showing the onboarding until providing a UI for the analysis.
The Screen API, in turn, offers two different ways of implementation:</p>
<h4 id='ui-with-networking-recommended' class='heading'>UI with Networking (Recommended)</h4>

<p>Using this method you don&rsquo;t need to care about handling the analysis process with the [Gini Pay Api Library]](<a href="https://github.com/gini/gini-pay-api-lib-ios">https://github.com/gini/gini-pay-api-lib-ios</a>), you only need to provide your API credentials and a delegate to get the analysis results.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">viewController</span> <span class="o">=</span> <span class="kt">GiniPayBank</span><span class="o">.</span><span class="nf">viewController</span><span class="p">(</span><span class="nv">withClient</span><span class="p">:</span> <span class="n">client</span><span class="p">,</span>
                                               <span class="nv">configuration</span><span class="p">:</span> <span class="n">giniPayBankConfiguration</span><span class="p">,</span>
                                               <span class="nv">resultsDelegate</span><span class="p">:</span> <span class="n">giniCaptureResultsDelegate</span><span class="p">)</span>

<span class="nf">present</span><span class="p">(</span><span class="n">viewController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre>

<p>Optionally if you want to use <em>Certificate pinning</em>, provide metadata for the upload process, you can pass both your public key pinning configuration (see <a href="https://github.com/datatheorem/TrustKit">TrustKit repo</a> for more information), the metadata information and the <em>API type</em> (the <a href="https://pay-api.gini.net/documentation/#gini-pay-api-documentation-v1-0">Gini Pay API</a> is used by default) as follows:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">TrustKit</span>

<span class="k">let</span> <span class="nv">yourPublicPinningConfig</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nv">kTSKPinnedDomains</span><span class="p">:</span> <span class="p">[</span>
    <span class="s">"pay-api.gini.net"</span><span class="p">:</span> <span class="p">[</span>
        <span class="nv">kTSKPublicKeyHashes</span><span class="p">:</span> <span class="p">[</span>
        <span class="c1">// old *.gini.net public key</span>
        <span class="s">"cNzbGowA+LNeQ681yMm8ulHxXiGojHE8qAjI+M7bIxU="</span><span class="p">,</span>
        <span class="c1">// new *.gini.net public key, active from around June 2020</span>
        <span class="s">"zEVdOCzXU8euGVuMJYPr3DUU/d1CaKevtr0dW0XzZNo="</span>
    <span class="p">]],</span>
    <span class="s">"user.gini.net"</span><span class="p">:</span> <span class="p">[</span>
        <span class="nv">kTSKPublicKeyHashes</span><span class="p">:</span> <span class="p">[</span>
        <span class="c1">// old *.gini.net public key</span>
        <span class="s">"cNzbGowA+LNeQ681yMm8ulHxXiGojHE8qAjI+M7bIxU="</span><span class="p">,</span>
        <span class="c1">// new *.gini.net public key, active from around June 2020</span>
        <span class="s">"zEVdOCzXU8euGVuMJYPr3DUU/d1CaKevtr0dW0XzZNo="</span>
    <span class="p">]],</span>
<span class="p">]]</span> <span class="k">as</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]</span>

<span class="k">let</span> <span class="nv">viewController</span> <span class="o">=</span> <span class="kt">GiniPayBank</span><span class="o">.</span><span class="nf">viewController</span><span class="p">(</span><span class="nv">withClient</span><span class="p">:</span> <span class="n">client</span><span class="p">,</span>
                                               <span class="nv">configuration</span><span class="p">:</span> <span class="n">giniPayBankConfiguration</span><span class="p">,</span>
                                               <span class="nv">resultsDelegate</span><span class="p">:</span> <span class="n">giniCaptureResultsDelegate</span><span class="p">,</span>
                                               <span class="nv">publicKeyPinningConfig</span><span class="p">:</span> <span class="n">yourPublicPinningConfig</span><span class="p">,</span>
                                               <span class="nv">documentMetadata</span><span class="p">:</span> <span class="n">documentMetadata</span><span class="p">,</span>
                                               <span class="nv">api</span><span class="p">:</span> <span class="o">.</span><span class="k">default</span><span class="p">)</span>

<span class="nf">present</span><span class="p">(</span><span class="n">viewController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span><span class="kc">nil</span><span class="p">)</span>
</code></pre>

<blockquote>
<p>⚠️  <strong>Important</strong></p>

<ul>
<li>The document metadata for the upload process is intended to be used for reporting.</li>
<li>Starting from Gini Pay Bank SDK 1.0.3 certification pinning requires iOS 12.</li>
</ul>
</blockquote>
<h4 id='only-ui' class='heading'>Only UI</h4>

<p>In case that you decide to use only the UI and to handle all the analysis process (either using the <a href="https://github.com/gini/gini-pay-api-lib-ios">Gini Pay Api Library</a> or with your own implementation of the API), just get the <code>UIViewController</code> as follows:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">viewController</span> <span class="o">=</span> <span class="kt">GiniPayBank</span><span class="o">.</span><span class="nf">viewController</span><span class="p">(</span><span class="nv">withDelegate</span><span class="p">:</span> <span class="k">self</span><span class="p">,</span>
                                               <span class="nv">withConfiguration</span><span class="p">:</span> <span class="n">giniPayBankConfiguration</span><span class="p">)</span>

<span class="nf">present</span><span class="p">(</span><span class="n">viewController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre>
<h2 id='component-api' class='heading'>Component API</h2>

<p>The Component API provides a custom <code>UIViewController</code> for each screen. This allows a maximum of flexibility, as the screens can be presented modally, used in a container view or pushed to a navigation view controller. Make sure to add your own navigational elements around the provided views.</p>

<p>For using the <code><a href="Classes/GiniPayBankConfiguration.html">GiniPayBankConfiguration</a></code> with the Component API:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">giniPayBankConfiguration</span> <span class="o">=</span> <span class="kt">GiniPayBankConfiguration</span><span class="p">()</span>
<span class="o">.</span>
<span class="o">.</span>
<span class="o">.</span>
<span class="kt">GiniCapture</span><span class="o">.</span><span class="nf">setConfiguration</span><span class="p">(</span><span class="n">giniPayBankConfiguration</span><span class="o">.</span><span class="nf">captureConfiguration</span><span class="p">())</span>
</code></pre>

<p>The components that can be found in the library are:</p>

<ul>
<li><strong>Camera</strong>: The actual camera screen to capture the image of the document, to import a PDF or an image or to scan a QR Code (<code>CameraViewController</code>).</li>
<li><strong>Review</strong>: Offers the opportunity to the user to check the sharpness of the image and eventually to rotate it into reading direction (<code>ReviewViewController</code>).</li>
<li><strong>Multipage Review</strong>: Allows to check the quality of one or several images and the possibility to rotate and reorder them (<code>MultipageReviewViewController</code>).</li>
<li><strong>Analysis</strong>: Provides a UI for the analysis process of the document by showing the user capture tips when an image is analyzed or the document information when it is a PDF. In both cases an image preview of the document analyzed will be shown (<code>AnalysisViewController</code>).</li>
<li><strong>Help</strong>: Helpful tutorials indicating how to use the open with feature, which are the supported file types and how to capture better photos for a good analysis (<code>HelpMenuViewController</code>).</li>
<li><strong>No results</strong>: Shows some suggestions to capture better photos when there are no results after an analysis (<code>ImageAnalysisNoResultsViewController</code>).</li>
</ul>
<h2 id='sending-feedback' class='heading'>Sending Feedback</h2>

<p>Your app should send feedback for the extractions the Gini Pay API delivered. Feedback should be sent only for the extractions the user has seen and accepted (or corrected).</p>

<p>For additional information about feedback see the <a href="https://pay-api.gini.net/documentation/#send-feedback-and-get-even-better-extractions-next-time">Gini Pay API documentation</a>.</p>
<h3 id='default-implementation' class='heading'>Default Implementation</h3>

<p>The example below shows how to correct extractions and send feedback using the default networking implementation:</p>

<p>You should send feedback only for extractions the user has seen and accepted.</p>
<pre class="highlight swift"><code><span class="k">var</span> <span class="nv">sendFeedbackBlock</span><span class="p">:</span> <span class="p">(([</span><span class="kt">String</span><span class="p">:</span> <span class="kt">Extraction</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span>
<span class="k">var</span> <span class="nv">extractions</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">Extraction</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

<span class="kd">func</span> <span class="nf">giniCaptureAnalysisDidFinishWith</span><span class="p">(</span><span class="nv">result</span><span class="p">:</span> <span class="kt">AnalysisResult</span><span class="p">,</span>
                           <span class="nv">sendFeedbackBlock</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">([</span><span class="kt">String</span><span class="p">:</span> <span class="kt">Extraction</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">){</span>

    <span class="k">self</span><span class="o">.</span><span class="n">extractions</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">extractions</span>
    <span class="k">self</span><span class="o">.</span><span class="n">sendFeedbackBlock</span> <span class="o">=</span> <span class="n">sendFeedbackBlock</span>
    <span class="nf">showResultsScreen</span><span class="p">(</span><span class="nv">results</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">extractions</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">value</span> <span class="p">})</span>
<span class="p">}</span>
<span class="o">.</span>
<span class="o">.</span>
<span class="o">.</span>
<span class="c1">// In this example only the amountToPay was wrong and we can reuse the other extractions.</span>
<span class="k">let</span> <span class="nv">updatedExtractions</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">extractions</span>
<span class="n">updatedExtractions</span><span class="o">.</span><span class="n">map</span><span class="p">{</span><span class="nv">$0</span><span class="o">.</span><span class="n">value</span><span class="p">}</span><span class="o">.</span><span class="nf">first</span><span class="p">(</span><span class="nv">where</span><span class="p">:</span> <span class="p">{</span><span class="nv">$0</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">"amountToPay"</span><span class="p">})?</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s">"31,25:EUR"</span>
<span class="nf">sendFeedbackBlock</span><span class="p">(</span><span class="n">updatedExtractions</span><span class="p">)</span>

</code></pre>
<h3 id='custom-implementation' class='heading'>Custom Implementation</h3>

<p>If you use your own networking implementation and directly communicate with the Gini Pay API then see <a href="https://pay-api.gini.net/documentation/#submitting-feedback-on-extractions">this section</a> in its documentation on how to send feedback.</p>

<p>In case you use the <a href="https://developer.gini.net/gini-pay-api-lib-ios/docs/">Gini Pay API Library</a> then see <a href="https://developer.gini.net/gini-pay-api-lib-ios/docs/getting-started.html">this section</a> in its documentation for details.</p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2021 <a class="link" href="https://gini.net" target="_blank" rel="external">Gini GmbH</a>. All rights reserved. (Last updated: 2021-09-27)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.1</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Integration  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="Integration  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
        <img class="logo-icon" src="img/logo.png"/>
    
        </a>
        
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/gini/gini-pay-bank-sdk-ios.git">
            <img class="header-icon" src="img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">GiniPayBank Reference</a>
      <img class="carat" src="img/carat.png" />
      Integration  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Documentation.html">Documentation</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="installation.html">Installation</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="integration.html">Integration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="license.html">License</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Classes.html">Other Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DigitalInvoiceViewController.html">DigitalInvoiceViewController</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DigitalInvoiceViewController/Section.html">– Section</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniPayBank.html">GiniPayBank</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniPayBankConfiguration.html">GiniPayBankConfiguration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniPayBankNetworkingScreenApiCoordinator.html">GiniPayBankNetworkingScreenApiCoordinator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ReturnAssistantConfiguration.html">ReturnAssistantConfiguration</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Global Variables.html">Other Global Variables</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Global%20Variables.html#/s:11GiniPayBank13versionStringSSvp">versionString</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Enumerations.html">Other Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/GiniPayBankError.html">GiniPayBankError</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Extensions.html">Other Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/DocumentServiceProtocol.html">DocumentServiceProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/LocalizableStringResource.html">LocalizableStringResource</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/ReturnReason.html">ReturnReason</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/String.html">String</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/URL.html">URL</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Functions.html">Other Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Functions.html#/s:11GiniPayBank23receivePaymentRequestId3url10completiony10Foundation3URLV_ys6ResultOySSAA0abC5ErrorOGctF">receivePaymentRequestId(url:completion:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Protocols.html">Other Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/DigitalInvoiceViewControllerDelegate.html">DigitalInvoiceViewControllerDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Protocols.html#/s:11GiniPayBank0abC16AnalysisDelegateP">GiniPayBankAnalysisDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Structures.html">Other Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DigitalInvoice.html">DigitalInvoice</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DigitalInvoice/DigitalInvoiceParsingException.html">– DigitalInvoiceParsingException</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DigitalInvoice.html#/s:11GiniPayBank14DigitalInvoiceV8LineItemV">– LineItem</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PaymentInfo.html">PaymentInfo</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            
            <h1 id='integration' class='heading'>Integration</h1>

<p>Gini Pay provides an information extraction system for analyzing business invoices and transfers them to the iOS banking app, where the payment process will be completed.</p>

<p>The Gini Pay Bank SDK for iOS provides functionality to upload the multipage documents with mobile phones, accurate line item extraction enables the user to to pay the invoice with prefferable payment provider. </p>

<p><strong>Note</strong> For supporting your banking app as a payment provider you need to register Gini Pay URL scheme in you  in your <code>Info.plist</code> file. Gini Pay URL schemes for specification will be provided by Gini.</p>

<p><br>
<center><img src="img/definingCustomUrl.png" height="200"/></center>
</br></p>
<h4 id='giniapilib-initialization' class='heading'>GiniApiLib initialization</h4>

<p>If you want to use a transparent proxy with your own authentication you can specify your own domain and add <code>AlternativeTokenSource</code> protocol implementation:</p>
<pre class="highlight swift"><code> <span class="k">let</span> <span class="nv">apiLib</span> <span class="o">=</span>  <span class="kt">GiniApiLib</span><span class="o">.</span><span class="kt">Builder</span><span class="p">(</span><span class="nv">customApiDomain</span><span class="p">:</span> <span class="s">"api.custom.net"</span><span class="p">,</span>
                                 <span class="nv">alternativeTokenSource</span><span class="p">:</span> <span class="kt">MyAlternativeTokenSource</span><span class="p">)</span>
                                 <span class="o">.</span><span class="nf">build</span><span class="p">()</span>
</code></pre>

<p>The token your provide will be added as a bearer token to all api.custom.net requests.</p>

<p>Optionally if you want to use <em>Certificate pinning</em>, provide metadata for the upload process, you can pass both your public key pinning configuration (see <a href="https://github.com/datatheorem/TrustKit">TrustKit repo</a> for more information)</p>
<pre class="highlight swift"><code>    <span class="k">let</span> <span class="nv">giniApiLib</span> <span class="o">=</span> <span class="kt">GiniApiLib</span>
        <span class="o">.</span><span class="kt">Builder</span><span class="p">(</span><span class="nv">client</span><span class="p">:</span> <span class="kt">Client</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"your-id"</span><span class="p">,</span>
                                <span class="nv">secret</span><span class="p">:</span> <span class="s">"your-secret"</span><span class="p">,</span>
                                <span class="nv">domain</span><span class="p">:</span> <span class="s">"your-domain"</span><span class="p">),</span>
                 <span class="nv">api</span><span class="p">:</span> <span class="o">.</span><span class="k">default</span><span class="p">,</span>
                 <span class="nv">pinningConfig</span><span class="p">:</span> <span class="n">yourPublicPinningConfig</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">build</span><span class="p">()</span>
</code></pre>

<blockquote>
<p>⚠️  <strong>Important</strong></p>

<ul>
<li>The document metadata for the upload process is intended to be used for reporting.</li>
</ul>
</blockquote>
<h2 id='ginipaybank-initialization' class='heading'>GiniPayBank initialization</h2>

<p>Now that the <code>GiniApiLib</code> has been initialized, you can initialize <code><a href="Classes/GiniPayBank.html">GiniPayBank</a></code></p>
<pre class="highlight swift"><code> <span class="k">let</span> <span class="nv">bankDK</span> <span class="o">=</span> <span class="kt">GiniPayBank</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">giniApiLib</span><span class="p">)</span>
</code></pre>

<p>and receive the payment requestID in <code>AppDelegate</code>. For handling incoming URL, please use the code snippet below.</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="n">_</span> <span class="nv">app</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span>
                     <span class="kd">open</span> <span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span><span class="p">,</span>
                     <span class="nv">options</span><span class="p">:</span> <span class="p">[</span><span class="kt">UIApplication</span><span class="o">.</span><span class="kt">OpenURLOptionsKey</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">[:])</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
        <span class="nf">receivePaymentRequestId</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
            <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
            <span class="k">case</span> <span class="kd">let</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="n">requestId</span><span class="p">):</span>
                <span class="k">self</span><span class="o">.</span><span class="n">paymentRequestId</span> <span class="o">=</span> <span class="n">requestId</span>
            <span class="k">case</span> <span class="o">.</span><span class="nv">failure</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">true</span>
    <span class="p">}</span>
</code></pre>
<h2 id='fetching-payment-information' class='heading'>Fetching payment information</h2>

<p>After receiving the payment request id you can get fetch the payment information:</p>
<pre class="highlight swift"><code>
<span class="n">bankSDK</span><span class="o">.</span><span class="nf">receivePaymentRequest</span><span class="p">(</span><span class="nv">paymentRequestId</span><span class="p">:</span> <span class="n">appDelegate</span><span class="o">.</span><span class="n">paymentRequestId</span><span class="p">)</span>

</code></pre>

<p>The method above returns the completion block with the struct <code>PaymentRequest</code>, which includes recipient, iban, amount and purpose fields.</p>
<h2 id='resolving-payment-request' class='heading'>Resolving payment request</h2>
<pre class="highlight swift"><code>
<span class="n">bankSDK</span><span class="o">.</span><span class="nf">resolvePaymentRequest</span><span class="p">(</span><span class="nv">paymentRequesId</span><span class="p">:</span> <span class="n">appDelegate</span><span class="o">.</span><span class="n">paymentRequestId</span><span class="p">,</span>
                                 <span class="nv">paymentInfo</span><span class="p">:</span> <span class="n">paymentInfo</span><span class="p">)</span>

</code></pre>

<p>The method above returns the completion block with the struct <code>ResolvedPaymentRequest</code>, which includes requesterUri for redirecting back to the busithe payment requester app.</p>
<h2 id='redirecting-back-to-the-payment-requester-app' class='heading'>Redirecting back to the payment requester app</h2>

<p>If the payment request was successfully resolved you can allow the user redirect back to the payment requester app:</p>
<pre class="highlight swift"><code><span class="n">bankSDK</span><span class="o">.</span><span class="nf">returnBackToBusinessAppHandler</span><span class="p">(</span><span class="nv">resolvedPaymentRequest</span><span class="p">:</span> <span class="n">resolvedPayment</span><span class="p">)</span>
</code></pre>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2021 <a class="link" href="https://gini.net" target="_blank" rel="external">Gini GmbH</a>. All rights reserved. (Last updated: 2021-05-11)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.1</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
